<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Quemador de Calor√≠as</title>
</head>

<body>
    <main>
        <div class="wrapper">
            <details>
                <summary>
                    ‚≠êÔ∏è explicaci√≥n
                </summary>
                <p>El libro, Convert Anything to Calories, lleg√≥ a la conclusi√≥n de que, en promedio, una persona con un
                    dedo
                    indice
                    de
                    10.8 cm^3 y de 11.7 gramos necesitar√° muuuchos clicks para conservar la l√≠nea. Se requieren 16.7
                    micromoles de
                    adenos√≠n
                    trifosfato (la mol√©cula que transporta energ√≠a entre las c√©lulas) para mover un gramo del cuerpo por
                    un
                    segundo,
                    y
                    como
                    hay 7.3 calor√≠as en un mol (la medida de cantidad de una sustancia) de adenos√≠n trifosfato, en
                    teor√≠a, cada
                    click
                    del
                    mouse deber√≠a quemar 1.42 calor√≠as. Aunque el c√°lculo asume el movimiento de todo el m√∫sculo, por lo
                    que la
                    cantidad
                    real puede variar un poco.</p>
                <p>Pero resulta que es s√°bado y tienes hambre. treinta minutos despu√©s te llega una pizza (1,835kCal)
                    con una
                    coca
                    (97kCal), tendr√≠as que hacer 1,360,563 clicks para quemar la cena. Y c√≥mo es s√°bado seguramente
                    involucrar√°
                    unas cuantas
                    bebidas alcoh√≥licas: en un Gin & Tonic (120kCal) hay 84,507 clicks, y 131,690.14 por cada cerveza
                    que
                    consumas. En otras
                    palabras, con 427 clicks en promedio por d√≠a, la computadora no es un buen ejercicio.
                </p>
            </details>
            <h1>Quemador de calor√≠as</h1>
            <p class="result" id="result"></p>
            <div class="container-button">
                <button id="burn" class="burn">üî•</button>
                <button id="total" class="burn">üí°</button>
            </div>
        </div>
    </main>

    <script>
        const createStore = (reducer, initialState) => {
            /**
             * Almacena el estado inicial y permite
             * actulizarce con el tiempo
             */
            let state = initialState

            /** 
             * Funcion actulizadora,
             * se lanza cada vez que haya
             * un cambio
            */
            let updater = () => { }

            /** 
             * Retorna el estado
            */
            const getState = () => state

            const dispatch = (action) => {
                /** 
                 * Cambia el estado apartir
                 * de la interpretacion que hace
                 * el reducer de la accion
                */
                state = reducer(state, action)

                /** 
                 * Invocamos el updater ya que 
                 * aca es donde ocurren los cambios
                */
                updater()
            }

            /** 
             * Se ejecuta cada vez que exista 
             * algun tipo de cambio
            */
            const subscribe = (listener) => {
                updater = listener
            }

            return {
                getState,
                dispatch,
                subscribe,
            }
        }

        /**
         * Evalua los comportamientos 
         * de las acciones y realiza las
         * interpretaciones de las mismas
         */
        const reducer = (state, action) => {
            switch (action.type) {
                case 'BURN':
                    return state + action.payload
                    break;
                default:
                    return state
                    break;
            }
        }

        const reducerClick = (state, action) => {
            switch (action.type) {
                case 'BURNCLICK':
                    return state > 0 ? state - action.payload : 0;
                    break;
                default:
                    return state
                    break;
            }
        }

        const store = createStore(reducer, 0)
        const storeClick = createStore(reducerClick, 1360563)

        // store.dispatch() -> Envio acciones
        // store.getState() -> Devuelve el estado
        // store.subscribe() -> Almacena una funcion que se dispara cada que cambia el estado


        /** 
         * Le enviamos una funcion
         * que se va a ejecutar
         * cada vez que haya un cambio
        */
        store.subscribe(() => {
            window.result.textContent = `Haz quemado ${store.getState().toFixed(2)} calorias`
        })

        storeClick.subscribe(() => {
            window.result.textContent = `Te faltan ${storeClick.getState()} clicks`
        })

        /** 
         * Se encarga de contar los clics
        */
        let i = 1

        const contador = () => {
            return i++
        }
        /** 
         * Despacha la nueva accion
        */
        const burn = () => {
            store.dispatch({
                type: 'BURN',
                payload: 1.42,
            })
            contador()
        }

        const burnClick = (contador) => {
            storeClick.dispatch({
                type: 'BURNCLICK',
                payload: contador,
            })
        }

        window.burn.addEventListener('click', burn)
        window.total.addEventListener('click', function () { burnClick(contador()) })
    </script>


</body>

</html>